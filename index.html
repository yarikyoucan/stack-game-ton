<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Stack Game</title>
  <style>
    /* --- –ë–ê–ó–ê –Ü–ù–¢–ï–†–§–ï–ô–°–£ --- */
    body{margin:0;font-family:Arial,sans-serif;background:#f4f4f4;display:flex;flex-direction:column;height:100vh;padding-bottom:64px}
    .page{flex:1;display:none;overflow:auto;padding:10px}.page.active{display:block}
    .menu{display:flex;justify-content:space-around;border-top:1px solid #ccc;background:#fff;padding:10px 0;position:fixed;left:0;right:0;bottom:0;z-index:9999}
    .menu button{flex:1;background:none;border:none;font-size:22px;cursor:pointer}.menu button.active{color:green;font-weight:bold}

    .task{display:flex;justify-content:space-between;align-items:center;background:#fff;padding:15px;margin:10px auto;border-radius:10px;width:90%;box-shadow:0 2px 5px rgba(0,0,0,.1)}
    .task button{background:#007bff;color:#fff;border:none;padding:8px 12px;border-radius:6px;cursor:pointer}.task button.done{background:#28a745}.task button:disabled{opacity:.6;cursor:not-allowed}
    .balance{font-size:20px;margin-bottom:20px;text-align:center}

    /* --- –ì–†–ê --- */
    #container{position:relative;width:100%;height:100%;overflow:hidden;background:#d0cbc7}
    #container canvas{position:absolute!important;top:0;left:0;width:100%!important;height:100%!important;z-index:1}
    #scoreboard{position:absolute;top:10px;left:10px;display:flex;gap:10px;z-index:2}
    #score,#highscore{background:rgba(0,0,0,.5);color:#fff;padding:5px 10px;border-radius:6px}
    #instructions{position:absolute;top:50px;left:10px;color:#000;font-size:16px;background:rgba(255,255,255,.7);padding:4px 8px;border-radius:6px;z-index:2}
    .hide{display:none}
    .game-over,.ready{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center;background:rgba(255,255,255,.95);padding:20px;border-radius:10px;display:none;z-index:3;min-width:260px;box-shadow:0 2px 5px rgba(0,0,0,.1)}

    /* --- ¬´–í–∏–∫–ª–∏–∫ —Å—É–ø–µ—Ä–Ω–∏–∫–∞¬ª --- */
    .tour-hero{width:90%;margin:12px auto;padding:16px;border-radius:14px;color:#fff;background:linear-gradient(135deg,#6a5acd,#5ac8fa)}
    .tour-hero-title{font-size:20px;font-weight:700}
    .tour-hero-sub{opacity:.95;margin-top:4px}
    .challenge-card{width:90%;margin:12px auto;background:#fff;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,.08);padding:14px}
    .challenge-row{display:flex;justify-content:space-between;align-items:center;gap:10px;margin:10px 0}
    .opponent-score{font-weight:700;font-size:20px}
    .stake-wrap{display:flex;gap:8px;align-items:center;flex:1}
    #stakeInput{flex:0 0 110px;padding:8px 10px;border:1px solid #ddd;border-radius:8px;font-size:14px}
    .challenge-countdown{margin-top:6px;font-weight:600}
    .challenge-actions{display:flex;align-items:center;gap:8px;margin-top:10px}

    /* (—Å—Ç–∞—Ä–∞ –∞—Ä–µ–Ω–∞ —Å—Ö–æ–≤–∞–Ω–∞) */
    .arena-wrap{ display:none !important; }

    /* --- –±–∞–Ω–µ—Ä –∑ –¥–≤–æ–º–∞ –ø—Ä—è–º–æ–∫—É—Ç–Ω–∏–∫–∞–º–∏, ¬´—ñ—Å–∫—Ä–∞–º–∏¬ª —Ç–∞ –∫—É–ª–∞–∫–∞–º–∏ --- */
    .duel-banner{
      position:relative; width:92%; margin:12px auto 8px;
      display:flex; align-items:center; justify-content:space-between; gap:10px;
    }
    .duel-banner .box{
      flex:1; height:68px; border-radius:16px;
      background:radial-gradient(120% 120% at 0% 0%, #ffffff 0%, #f3f6ff 40%, #e9eeff 100%);
      box-shadow:0 6px 16px rgba(0,0,0,.08), inset 0 1px 0 rgba(255,255,255,.6);
      position:relative; display:flex; align-items:center; justify-content:center; overflow:hidden;
    }
    .duel-banner .box::after{
      content:""; position:absolute; inset:-30%;
      background: radial-gradient(circle, rgba(255,235,59,.35), transparent 60%);
      filter: blur(18px); opacity:.4;
    }
    .duel-banner .sparks{
      position:absolute; left:50%; top:50%; transform:translate(-50%,-50%);
      width:48px; height:32px; pointer-events:none;
    }
    .duel-banner .sparks i{
      position:absolute; width:12px; height:12px; border-radius:50%;
      background: radial-gradient(circle, #ffd54f, rgba(255,213,79,0) 60%);
      opacity:.85; animation:blink 1.6s ease-in-out infinite;
    }
    .duel-banner .sparks i:nth-child(1){ left:2px;  top:-4px; animation-delay:.0s; }
    .duel-banner .sparks i:nth-child(2){ left:16px; top:6px;  animation-delay:.5s; }
    .duel-banner .sparks i:nth-child(3){ left:28px; top:-2px; animation-delay:1.0s; }
    @keyframes blink{ 0%,100%{ transform:scale(.5); opacity:.35 } 50%{ transform:scale(1.15); opacity:1 } }
    .fist{ font-size:40px; line-height:1; text-shadow:0 2px 2px rgba(0,0,0,.15) }
    .fist-left{ transform:translateX(4px) } .fist-right{ transform:translateX(-4px) }
    @media (max-width:420px){ .duel-banner .box{height:62px} .fist{font-size:36px} }

    /* —Å–º—É–∂–∫–∞-–ø—ñ–¥–ø–∏—Å */
    .duel-ribbon{ width:92%; margin:6px auto 10px; }
    .duel-ribbon .strip{
      height:32px; border-radius:999px;
      background:linear-gradient(135deg,#6a5acd 0%, #5ac8fa 100%);
      color:#fff; display:flex; align-items:center; justify-content:center;
      font-weight:800; letter-spacing:1.6px; text-transform:uppercase; font-size:14px;
      box-shadow:0 4px 12px rgba(90,100,255,.25); user-select:none;
    }

    /* –∫–æ—Ä–æ—Ç–∫—ñ –ø—Ä–∞–≤–∏–ª–∞ */
    .duel-footer{ width:92%; margin:8px auto 10px; }
    .duel-footer .pill{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      padding:10px 12px; border-radius:14px;
      background:linear-gradient(90deg,#edf1ff 0%, #f7f9ff 100%);
      box-shadow:0 6px 16px rgba(0,0,0,.06), inset 0 1px 0 rgba(255,255,255,.7);
      color:#2f2f44; font-size:13px; font-weight:600; flex-wrap:wrap;
    }
    .duel-footer .item{ display:flex; align-items:center; gap:6px; white-space:nowrap; }
    .duel-footer .sep{ width:1px; height:18px; background:rgba(0,0,0,.08); }
    @media (max-width:480px){
      .duel-footer .sep{ display:none; }
      .duel-footer .pill{ justify-content:center; row-gap:6px; }
    }

    /* ‚ñº –ù–ò–ñ–ù–Ü–ô –ü–û–ü–ï–†–ï–î–ñ–£–í–ê–õ–¨–ù–ò–ô –ë–ê–ù–ï–† (–ø–æ–≤–µ—Ä–Ω—É—Ç–æ) */
    .loss-banner{
      width:92%; margin:8px auto 90px;
      background:linear-gradient(135deg,#ff6a6a 0%, #ffb86c 100%);
      color:#fff; border-radius:14px; padding:10px 12px;
      box-shadow:0 8px 18px rgba(255,120,120,.25);
      font-weight:700; text-align:center;
    }
    .loss-banner small{ display:block; opacity:.9; font-weight:600; }

    /* –î–†–£–ó–Ü */
    .share-card{width:90%;margin:12px auto;background:#fff;border-radius:10px;box-shadow:0 2px 5px rgba(0,0,0,.1);padding:16px}
    .share-row{display:flex;gap:8px;margin-top:8px}
    .share-row input{flex:1;padding:8px 10px;border:1px solid #ddd;border-radius:8px;font-size:14px}
    .share-actions{display:flex;gap:8px;margin-top:8px;align-items:center;flex-wrap:wrap}
    .btn{background:#007bff;color:#fff;border:none;padding:8px 12px;border-radius:6px;cursor:pointer;text-decoration:none;display:inline-block}
    .muted{color:#6c757d;font-size:12px}
    .ok{color:#198754}.err{color:#dc3545}

    /* —Å–ø–∏—Å–æ–∫ –≤–∏–≤–æ–¥—ñ–≤ */
    .payout-list{list-style:none;margin:8px 0 0;padding:0}
    .payout-list li{padding:6px 8px;border:1px solid #eee;border-radius:8px;margin-top:6px;font-size:14px}
  </style>
</head>
<body>

  <!-- GAME -->
  <div id="game" class="page active">
    <div id="container">
      <div id="scoreboard">
        <div id="score">0</div>
        <div id="highscore">üèÜ 0</div>
      </div>
      <div id="instructions">–ö–ª—ñ–∫ –∞–±–æ –ø—Ä–æ–±—ñ–ª ‚Äî –ø–æ—Å—Ç–∞–≤–∏—Ç–∏ –±–ª–æ–∫. –ü—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è ‚Äî –∫–ª—ñ–∫–Ω–∏/–ø—Ä–æ–±—ñ–ª, —â–æ–± –∑—ñ–≥—Ä–∞—Ç–∏ —â–µ.</div>

      <div class="game-over" id="gameOver">
        <h2>–ì—Ä–∞ –∑–∞–∫—ñ–Ω—á–µ–Ω–∞</h2>
        <p>–¢–∏ –º–æ–ª–æ–¥–µ—Ü—å üëç</p>
        <p>–ö–ª—ñ–∫–Ω–∏ –∞–±–æ –Ω–∞—Ç–∏—Å–Ω–∏ –ø—Ä–æ–±—ñ–ª, —â–æ–± –ø–æ—á–∞—Ç–∏ –∑–Ω–æ–≤—É</p>
      </div>

      <div class="ready" id="ready">
        <div id="start-button" style="cursor:pointer;">‚ñ∂ –°—Ç–∞—Ä—Ç</div>
      </div>

      <!-- 15-—Å —Ç–∞–π–º–µ—Ä –ø—ñ—Å–ª—è —Ä–µ–∫–ª–∞–º–∏ –ø–æ Game Over -->
      <div class="game-over" id="postAdTimer" style="display:none;">
        <h2>–ü–∞—É–∑–∞ –ø–µ—Ä–µ–¥ –Ω–æ–≤–æ—é –≥—Ä–æ—é</h2>
        <p>–ú–æ–∂–Ω–∞ –±—É–¥–µ –ø–æ—á–∞—Ç–∏ —á–µ—Ä–µ–∑: <b id="postAdCountdown">15</b> —Å</p>
      </div>
    </div>
  </div>

  <!-- TASKS -->
  <div id="tasks" class="page">
    <h2>üìã –ó–∞–≤–¥–∞–Ω–Ω—è</h2>

    <div class="task">
      <span>–ü—ñ–¥–ø–∏—à–∏—Å—å –Ω–∞ –∫–∞–Ω–∞–ª +1‚≠ê</span>
      <button id="subscribeBtn">–ü–µ—Ä–µ–π—Ç–∏</button>
    </div>

    <div class="task" id="task50">
      <span>üéØ –î–æ—Å—è–≥–Ω–∏ —Ä–µ–∫–æ—Ä–¥—É 75 (+10‚≠ê)</span>
      <button id="checkTask50">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏</button>
    </div>

    <div class="task" id="taskAdOncePerMinute">
      <span>üé¨ –ü–µ—Ä–µ–≥–ª—è–Ω—å —Ä–µ–∫–ª–∞–º—É +0.15‚≠ê <small>(—Ä–∞–∑ –Ω–∞ 1 —Ö–≤)</small></span>
      <button id="watchAdMinuteBtn">–î–∏–≤–∏—Ç–∏—Å—å</button>
    </div>
    <div class="task" id="taskAdStatus" style="display:none;">
      <span>‚åõ –ù–∞—Å—Ç—É–ø–Ω–∏–π –ø–µ—Ä–µ–≥–ª—è–¥ –¥–æ—Å—Ç—É–ø–Ω–∏–π —á–µ—Ä–µ–∑: <span id="adCooldownText">60—Å</span></span>
      <button disabled>–û—á—ñ–∫—É–π‚Ä¶</button>
    </div>

    <div class="task" id="taskWatch5">
      <span>üé¨ –ü–µ—Ä–µ–≥–ª—è–Ω—å 5 —Ä–µ–∫–ª–∞–º (+1‚≠ê) ‚Äî <b id="ad5Counter">0/5</b></span>
      <button id="watchAd5Btn">–î–∏–≤–∏—Ç–∏—Å—è</button>
    </div>
    <div class="task" id="taskWatch5Cooldown" style="display:none;">
      <span>‚åõ ¬´5 —Ä–µ–∫–ª–∞–º¬ª –¥–æ—Å—Ç—É–ø–Ω–µ —á–µ—Ä–µ–∑: <span id="ad5CooldownText">‚Äî</span></span>
      <button disabled>–û—á—ñ–∫—É–π‚Ä¶</button>
    </div>

    <div class="task" id="taskWatch10">
      <span>üé¨ –ü–µ—Ä–µ–≥–ª—è–Ω—å 10 —Ä–µ–∫–ª–∞–º (+2‚≠ê) ‚Äî <b id="ad10Counter">0/10</b></span>
      <button id="watchAd10Btn">–î–∏–≤–∏—Ç–∏—Å—è</button>
    </div>
    <div class="task" id="taskWatch10Cooldown" style="display:none;">
      <span>‚åõ ¬´10 —Ä–µ–∫–ª–∞–º¬ª –¥–æ—Å—Ç—É–ø–Ω–µ —á–µ—Ä–µ–∑: <span id="ad10CooldownText">‚Äî</span></span>
      <button disabled>–û—á—ñ–∫—É–π‚Ä¶</button>
    </div>

    <div class="task" id="taskGames100">
      <span>üéÆ –ó—ñ–≥—Ä–∞–π 100 —ñ–≥–æ—Ä (+10‚≠ê) ‚Äî –∑—ñ–≥—Ä–∞–Ω–æ: <b id="gamesPlayedCounter">0</b>/100</span>
      <button id="checkGames100Btn">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏</button>
    </div>
  </div>

  <!-- TOURNAMENTS -->
  <div id="tournaments" class="page">
    <div class="tour-hero">
      <div class="tour-hero-title">‚öîÔ∏è –í–∏–∫–ª–∏–∫ —Å—É–ø–µ—Ä–Ω–∏–∫–∞</div>
      <div class="tour-hero-sub">–ó–≥–µ–Ω–µ—Ä—É–π —Ä–µ–∫–æ—Ä–¥, –∑—Ä–æ–±–∏ —Å—Ç–∞–≤–∫—É ‚≠ê —ñ –ø–æ–±–∏–π –π–æ–≥–æ –∑–∞ 3 –≥–æ–¥–∏–Ω–∏</div>
    </div>

    <div class="challenge-card">
      <div class="challenge-row">
        <div>
          <div class="muted">–°—É–ø–µ—Ä–Ω–∏–∫</div>
          <div class="opponent-score" id="opponentScore">‚Äî</div>
        </div>
        <button class="btn" id="genOpponentBtn">–ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏</button>
      </div>

      <div class="challenge-row">
        <label for="stakeInput" class="muted">–°—Ç–∞–≤–∫–∞ ‚≠ê</label>
        <div class="stake-wrap">
          <input id="stakeInput" type="number" min="1" step="0.5" value="1" />
          <button class="btn" id="startChallengeBtn">–ü–æ—á–∞—Ç–∏ –≤–∏–∫–ª–∏–∫ (3 –≥–æ–¥)</button>
        </div>
      </div>

      <div class="challenge-info" id="challengeInfo">–ù–µ–º–∞—î –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –≤–∏–∫–ª–∏–∫—É.</div>

      <div class="challenge-countdown" id="challengeCountdown" style="display:none;">
        ‚è≥ –ó–∞–ª–∏—à–∏–ª–æ—Å—å: <span id="challengeLeft">03:00:00</span>
      </div>

      <div class="challenge-actions">
        <button class="btn" id="checkChallengeBtn" disabled>–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏</button>
        <span id="challengeStatus" class="muted"></span>
      </div>
    </div>

    <!-- –ë–∞–Ω–µ—Ä: –¥–≤–∞ –ø—Ä—è–º–æ–∫—É—Ç–Ω–∏–∫–∏ + ¬´—ñ—Å–∫—Ä–∏¬ª + –∫—É–ª–∞–∫–∏ -->
    <div class="duel-banner" aria-label="–ê—Ä–µ–Ω–∞ –±–∞—Ç–ª—É">
      <div class="box"><span class="fist fist-left">ü§ú</span></div>
      <div class="sparks"><i></i><i></i><i></i></div>
      <div class="box"><span class="fist fist-right">ü§õ</span></div>
    </div>

    <!-- –°–º—É–∂–∫–∞ ¬´BATTLES¬ª -->
    <div class="duel-ribbon"><div class="strip">BATTLES</div></div>

    <!-- –ö–æ—Ä–æ—Ç–∫—ñ –ø—Ä–∞–≤–∏–ª–∞ -->
    <div class="duel-footer">
      <div class="pill">
        <div class="item">üéØ –ú–µ—Ç–∞: –ø–æ–±–∏–π —Ä–µ–∫–æ—Ä–¥ –∑–∞ 3 –≥–æ–¥</div>
        <div class="sep"></div>
        <div class="item">üíé –í–∏–≥—Ä–∞—à: √ó1.5 –≤—ñ–¥ —Å—Ç–∞–≤–∫–∏</div>
        <div class="sep"></div>
        <div class="item">‚ö†Ô∏è –ü—Ä–æ–≥—Ä–∞—à: —Å—Ç–∞–≤–∫–∞ –∑–≥–æ—Ä–∞—î</div>
      </div>
    </div>

    <!-- ‚ñº –ù–∏–∂–Ω—ñ–π –ø–æ–ø–µ—Ä–µ–¥–∂—É–≤–∞–ª—å–Ω–∏–π –±–∞–Ω–µ—Ä -->
    <div class="loss-banner">
      ‚ö†Ô∏è –£–í–ê–ì–ê: —è–∫—â–æ –Ω–µ –ø–æ–±‚Äô—î—à —Ä–µ–∫–æ—Ä–¥ –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è —á–∞—Å—É ‚Äî —Å—Ç–∞–≤–∫–∞ –ø–æ–≤–Ω—ñ—Å—Ç—é –∑–≥–æ—Ä–∞—î.
      <small>–ì—Ä–∞–π –æ–±–µ—Ä–µ–∂–Ω–æ —Ç–∞ –ø–ª–∞–Ω—É–π —Å–ø—Ä–æ–±–∏!</small>
    </div>
  </div>

  <!-- FRIENDS -->
  <div id="friends" class="page">
    <div class="balance">–ë–∞–ª–∞–Ω—Å ‚≠ê <span id="balance">0</span></div>
    <h2>üí≥ –ì–∞–º–∞–Ω–µ—Ü—å</h2>

    <div class="share-card">
      <div><strong>–ó–∞–ø—Ä–æ—Å–∏ –¥—Ä—É–∑—ñ–≤</strong></div>
      <p>–ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –±–æ—Ç–∞:</p>
      <p style="margin:8px 0;">
        <a href="https://t.me/Stacktongame_bot" class="btn" onclick="openBotLink(event)">
          ‚û° –í—ñ–¥–∫—Ä–∏—Ç–∏ –±–æ—Ç–∞ @Stacktongame_bot
        </a>
      </p>
      <div class="share-row">
        <input id="shareLink" type="text" readonly value="https://t.me/Stacktongame_bot"/>
        <button class="btn" id="copyShareBtn">–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏</button>
      </div>
      <div class="muted">–¶–µ –æ–¥–Ω–∞ —Å–∏–ª–∫–∞ –¥–ª—è –≤—Å—ñ—Ö üëç</div>
    </div>

    <div class="share-card">
      <div><strong>–í–∏–≤—ñ–¥ –∑—ñ—Ä–æ–∫</strong></div>
      <div class="muted">–ó–∞ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è —Å–ø–∏—Å—É—î—Ç—å—Å—è —Ä—ñ–≤–Ω–æ 50‚≠ê, —Ä–µ—à—Ç–∞ –ª–∏—à–∞—î—Ç—å—Å—è. –î–∞–ª—ñ –≤—ñ–¥–∫—Ä–∏—î—Ç—å—Å—è –≥—Ä—É–ø–∞/¬´–ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è¬ª –∑ –≥–æ—Ç–æ–≤–∏–º –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º —ñ –¥–≤–æ–º–∞ –∫–æ–¥–∞–º–∏.</div>
      <div class="share-actions">
        <button class="btn" id="withdrawBtn">–í–∏–≤–µ—Å—Ç–∏</button>
        <span id="withdrawStatus" class="muted"></span>
      </div>
    </div>

    <!-- –°–ø–∏—Å–æ–∫ –≤–∏–≤–æ–¥—ñ–≤ -->
    <div class="share-card">
      <div><strong>–°–ø–∏—Å–æ–∫ –≤–∏–≤–æ–¥—ñ–≤</strong></div>
      <ul id="payoutList" class="payout-list"></ul>
    </div>
  </div>

  <!-- BOTTOM MENU -->
  <div class="menu">
    <button onclick="showPage('game', this)" class="active">üéÆ</button>
    <button onclick="showPage('tasks', this)">üìù</button>
    <button onclick="showPage('tournaments', this)">‚öîÔ∏è</button>
    <button onclick="showPage('friends', this)">üëõ</button>
  </div>

  <!-- Libs -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r83/three.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/latest/TweenMax.min.js"></script>
  <script src="https://sad.adsgram.ai/js/sad.min.js"></script>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <!-- App -->
  <script src="./script.js"></script>
</body>
</html>
