<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Stack Game</title>
  <style>
    /* --- БАЗА ІНТЕРФЕЙСУ --- */
    body{margin:0;font-family:Arial,sans-serif;background:#0f172a;display:flex;flex-direction:column;height:100vh;padding-bottom:64px}
    .page{flex:1;display:none;overflow:auto;padding:10px}.page.active{display:block}

    /* Нижнє меню — напівпрозоре */
    .menu{display:flex;justify-content:space-around;border-top:1px solid rgba(255,255,255,.15);background:rgba(15,23,42,.75);padding:10px 0;position:fixed;left:0;right:0;bottom:0;z-index:9999;backdrop-filter:blur(6px)}
    .menu button{flex:1;background:none;border:none;font-size:22px;cursor:pointer;color:#fff}.menu button.active{color:#3b82f6;font-weight:bold}

    .task{display:flex;justify-content:space-between;align-items:center;background:#fff;padding:15px;margin:10px auto;border-radius:10px;width:90%;box-shadow:0 2px 5px rgba(0,0,0,.1)}
    .task button{background:#007bff;color:#fff;border:none;padding:8px 12px;border-radius:6px;cursor:pointer}.task button.done{background:#28a745}.task button:disabled{opacity:.6;cursor:not-allowed}
    .balance{font-size:20px;margin-bottom:20px;text-align:center}

    /* --- ГРА: фон + прозорий canvas --- */
    #container{
      position:relative;width:100%;height:100%;overflow:hidden;
      background:
        url('data:image/svg+xml;utf8,\
<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160">\
  <defs>\
    <radialGradient id="g" cx="40%" cy="40%" r="60%">\
      <stop offset="0%" stop-color="%23fff9c4"/><stop offset="50%" stop-color="%23ffe082"/><stop offset="100%" stop-color="%23ffd54f00"/>\
    </radialGradient>\
    <clipPath id="crescent"><circle cx="80" cy="80" r="44"/></clipPath>\
  </defs>\
  <circle cx="80" cy="80" r="46" fill="%23ffe082" opacity="0.95"/><g clip-path="url(%23crescent)"><circle cx="68" cy="78" r="60" fill="url(%23g)"/></g>\
</svg>') no-repeat 95% 8%,
        url('data:image/svg+xml;utf8,\
<svg xmlns="http://www.w3.org/2000/svg" width="140" height="140" viewBox="0 0 140 140">\
  <g fill="%23ffffff" opacity="0.7">\
    <circle cx="15" cy="10" r="1.2"/><circle cx="40" cy="28" r="0.9"/><circle cx="85" cy="20" r="1.1"/><circle cx="120" cy="36" r="1.3"/><circle cx="60" cy="54" r="0.8"/><circle cx="18" cy="72" r="1.0"/><circle cx="100" cy="78" r="1.1"/><circle cx="130" cy="92" r="0.9"/><circle cx="32" cy="110" r="1.2"/><circle cx="72" cy="118" r="0.9"/><circle cx="8" cy="126" r="1.0"/>\
  </g></svg>') repeat,
        url('data:image/svg+xml;utf8,\
<svg xmlns="http://www.w3.org/2000/svg" width="800" height="220" viewBox="0 0 800 220">\
  <rect width="800" height="220" fill="none"/>\
  <path d="M0 190 L20 170 L45 172 L45 190 L70 160 L95 162 L95 190 L130 150 L160 152 L160 190 L200 165 L230 167 L230 190 L270 155 L310 157 L310 190 L350 170 L380 172 L380 190 L420 160 L455 162 L455 190 L495 168 L530 170 L530 190 L570 156 L610 158 L610 190 L650 170 L690 172 Л690 190 L730 160 L770 165 L770 190 L800 150 L800 220 L0 220 Z" fill="%23040a1c"/>\
  <path d="M0 200 L30 180 L50 180 L50 200 L80 155 L110 155 L110 200 L150 140 L180 140 L180 200 L220 165 L250 165 Л250 200 L300 145 L340 145 L340 200 Л380 175 Л420 175 Л420 200 Л460 150 Л500 150 Л500 200 Л540 165 Л580 165 Л580 200 Л620 145 Л660 145 Л660 200 Л700 175 Л740 175 Л740 200 Л800 160 Л800 220 Л0 220 Z" fill="%23000a1a"/>\
  <g fill="%23ffd34d">\
    <rect x="58" y="184" width="6" height="10"/><rect x="66" y="184" width="6" height="10" opacity="0.6"/>\
    <rect x="206" y="186" width="6" height="10"/><rect x="214" y="186" width="6" height="10" opacity="0.6"/>\
    <rect x="362" y="188" width="6" height="10"/><rect x="370" y="188" width="6" height="10" opacity="0.6"/>\
    <rect x="526" y="186" width="6" height="10"/><rect x="534" y="186" width="6" height="10" opacity="0.6"/>\
    <rect x="686" y="188" width="6" height="10"/><rect x="694" y="188" width="6" height="10" opacity="0.6"/>\
  </g></svg>') bottom repeat-x,
        linear-gradient(180deg,#1e1b4b 0%, #0b1020 60%, #090f1a 100%);
      background-size:160px 160px,140px 140px,auto 220px,cover;
      background-position:95% 8%,center,bottom,center;
    }
    #container canvas{position:absolute!important;top:0;left:0;width:100%!important;height:100%!important;z-index:1!important;background:transparent!important}
    #scoreboard{position:absolute;top:10px;left:10px;display:flex;gap:10px;z-index:2}
    #score,#highscore{background:rgba(0,0,0,.5);color:#fff;padding:5px 10px;border-radius:6px}
    #instructions{position:absolute;top:50px;left:10px;color:#fff;font-size:16px;background:rgba(0,0,0,.4);padding:4px 8px;border-radius:6px;z-index:2}
    .hide{display:none}
    .game-over,.ready{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center;background:rgba(15,23,42,.95);color:#fff;padding:20px;border-radius:10px;display:none;z-index:3;min-width:260px;box-shadow:0 2px 5px rgba(0,0,0,.35)}

    .lang-btn{position:absolute;top:10px;right:10px;z-index:3;background:rgba(255,255,255,.12);color:#eaf2ff;border:1px solid rgba(255,255,255,.25);padding:6px 10px;border-radius:10px;font-weight:800;letter-spacing:.5px;cursor:pointer;backdrop-filter:blur(6px)}
    .lang-btn:hover{filter:brightness(1.05)}

    .share-card{width:90%;margin:12px auto;background:#fff;border-radius:10px;box-shadow:0 2px 5px rgba(0,0,0,.1);padding:16px}
    .share-row{display:flex;gap:8px;margin-top:8px}
    .share-row input{flex:1;padding:8px 10px;border:1px solid #ddd;border-radius:8px;font-size:14px}
    .share-actions{display:flex;gap:8px;margin-top:8px;align-items:center;flex-wrap:wrap}
    .btn{background:#007bff;color:#fff;border:none;padding:8px 12px;border-radius:6px;cursor:pointer;text-decoration:none;display:inline-block}
    .muted{color:#c7d2fe;font-size:12px}
    .ok{color:#198754}.err{color:#dc3545}
    .payout-list{list-style:none;margin:8px 0 0;padding:0}
    .payout-list li{padding:6px 8px;border:1px solid #eee;border-radius:8px;margin-top:6px;font-size:14px}

    .themed{
      position:relative;color:#eef;padding-bottom:84px;
      background:
        radial-gradient(1200px 500px at 15% 0%, rgba(99,102,241,.35), transparent 60%),
        radial-gradient(1000px 600px at 85% 100%, rgba(56,189,248,.25), transparent 60%),
        linear-gradient(135deg,#0f172a 0%, #1e1b4b 45%, #3b82f6 100%);
    }
    #tasks.themed{
      background-image:
        radial-gradient(1200px 500px at 15% 0%, rgba(99,102,241,.35), transparent 60%),
        radial-gradient(1000px 600px at 85% 100%, rgba(56,189,248,.25), transparent 60%),
        linear-gradient(135deg,#0f172a 0%, #1e1b4b 45%, #3b82f6 100%),
        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="620" height="180"><g fill="%23ffffff1f" font-family="Arial, Helvetica, sans-serif" font-size="28" font-weight="800" transform="rotate(-18 310 90)"><text x="-60" y="40">TASKS • TASKS • TASKS • TASKS • TASKS •</text><text x="-60" y="100">TASKS • TASKS • TASKS • TASKS • TASKS •</text><text x="-60" y="160">TASKS • TASKS • TASKS • TASKS • TASKS •</text></g></svg>');
      background-size:auto,auto,auto,620px 180px;background-repeat:no-repeat,no-repeat,no-repeat,repeat;
    }
    #friends.themed{
      background-image:
        radial-gradient(1200px 500px at 15% 0%, rgba(99,102,241,.35), transparent 60%),
        radial-gradient(1000px 600px at 85% 100%, rgba(56,189,248,.25), transparent 60%),
        linear-gradient(135deg,#0f172a 0%, #1e1b4b 45%, #3b82f6 100%),
        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="640" height="180"><g fill="%23ffffff1f" font-family="Arial, Helvetica, sans-serif" font-size="28" font-weight="800" transform="rotate(-18 320 90)"><text x="-60" y="40">WALLET • WALLET • WALLET • WALLET • WALLET •</text><text x="-60" y="100">WALLET • WALLET • WALLET • WALLET • WALLET •</text><text x="-60" y="160">WALLET • WALLET • WALLET • WALLET • WALLET •</text></g></svg>');
      background-size:auto,auto,auto,640px 180px;background-repeat:no-repeat,no-repeat,no-repeat,repeat;
    }
    #shop.themed{
      background-image:
        radial-gradient(1200px 500px at 15% 0%, rgba(99,102,241,.35), transparent 60%),
        radial-gradient(1000px 600px at 85% 100%, rgba(56,189,248,.25), transparent 60%),
        linear-gradient(135deg,#0f172a 0%, #1e1b4b 45%, #3b82f6 100%),
        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="640" height="180"><g fill="%23ffffff1a" font-family="Arial, Helvetica, sans-serif" font-size="28" font-weight="800" transform="rotate(-18 320 90)"><text x="-60" y="40">SHOP • SHOP • SHOP • SHOP • SHOP •</text><text x="-60" y="100">SHOP • SHOP • SHOP • SHOP • SHOP •</text><text x="-60" y="160">SHOP • SHOP • SHOP • SHOP • SHOP •</text></g></svg>');
      background-size:auto,auto,auto,640px 180px;background-repeat:no-repeat,no-repeat,no-repeat,repeat;
    }
    .themed .task,.themed .share-card{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.15);color:#eef;backdrop-filter:blur(6px);box-shadow:0 10px 30px rgba(0,0,0,.15)}
    .themed .btn{background:#3b82f6;color:#fff;border:none}
    .themed .btn:hover{filter:brightness(1.05)}

    #tasksTitle{color:#eaf2ff;margin:6px 0 8px 14px;font-size:28px}
    #friends .balance{font-size:30px;font-weight:800;text-align:center;margin:16px 0;color:#eaf2ff}
    #friends h2.wallet-title{color:#eaf2ff;text-align:center;font-size:28px;margin:0 0 20px}

    /* ======= ЛІДЕРБОРД ======= */
    #leaderboard.themed{
      background-image:
        radial-gradient(1200px 500px at 15% 0%, rgba(99,102,241,.35), transparent 60%),
        radial-gradient(1000px 600px at 85% 100%, rgba(56,189,248,.25), transparent 60%),
        linear-gradient(135deg,#0f172a 0%, #1e1b4b 45%, #3b82f6 100%),
        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="760" height="200"><g fill="%23ffffff15" font-family="Arial, Helvetica, sans-serif" font-size="36" font-weight="800" transform="rotate(-18 380 100)"><text x="-60" y="40">LEADERBOARD • LEADERBOARD • LEADERBOARD •</text><text x="-60" y="100">LEADERBOARD • LEADERBOARD • LEADERBOARD •</text><text x="-60" y="160">LEADERBOARD • LEADERBOARD • LEADERBOARD •</text></g></svg>');
      background-size:auto,auto,auto,760px 200px;background-repeat:no-repeat,no-repeat,no-repeat,repeat;
      color:#eaf2ff; padding-bottom:84px;
    }
    .lb-header{width:92%;margin:12px auto 8px}
    .lb-title{font-size:26px;margin:0 0 4px}
    .lb-sub{opacity:.9;margin:0 0 10px}
    .lb-note{width:92%;margin:4px auto 16px;font-size:13px;opacity:.9}

    .lb-row{
      display:grid;
      grid-template-columns:56px 1fr 70px 90px; /* rank | name | ?⭐ | рекорд */
      align-items:center;gap:10px;
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.15);
      padding:10px 12px;border-radius:12px;
      backdrop-filter:blur(6px);
      box-shadow:0 8px 20px rgba(0,0,0,.15);
      width:92%; margin:0 auto 8px;
    }
    .lb-rank{font-weight:900;font-size:18px;text-align:center}
    .lb-name{display:flex;align-items:center;gap:10px;min-width:0}
    .lb-name img{width:28px;height:28px;border-radius:50%;object-fit:cover;border:1px solid rgba(255,255,255,.3)}
    .lb-name .txt{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
    .lb-bonus{ text-align:center; font-weight:800; opacity:.95 }
    .lb-score{ text-align:right; font-weight:800 }

    .rank-1{background:linear-gradient(135deg,rgba(250,204,21,.25),rgba(255,255,255,.06));border-color:rgba(250,204,21,.6)}
    .rank-2{background:linear-gradient(135deg,rgba(148,163,184,.25),rgba(255,255,255,.06));border-color:rgba(148,163,184,.6)}
    .rank-3{background:linear-gradient(135deg,rgba(244,114,182,.25),rgba(255,255,255,.06));border-color:rgba(244,114,182,.6)}
  </style>
</head>
<body>

  <!-- GAME -->
  <div id="game" class="page active">
    <div id="container">
      <button id="langToggle" class="lang-btn">UA</button>

      <div id="scoreboard">
        <div id="score">0</div>
        <div id="highscore">🏆 0</div>
      </div>
      <div id="instructions">Клік або пробіл — поставити блок. Після завершення — клікни/пробіл, щоб зіграти ще.</div>

      <div class="game-over" id="gameOver">
        <h2>Гра закінчена</h2>
        <p>Ти молодець 👍</p>
        <p>Клікни або натисни пробіл, щоб почати знову</p>
      </div>

      <div class="ready" id="ready">
        <div id="start-button" style="cursor:pointer;">▶ Старт</div>
      </div>

      <div class="game-over" id="postAdTimer" style="display:none;">
        <h2>Пауза перед новою грою</h2>
        <p>Можна буде почати через: <b id="postAdCountdown">15</b> с</p>
      </div>
    </div>
  </div>

  <!-- TASKS -->
  <div id="tasks" class="page themed">
    <h2 id="tasksTitle">📋 Завдання</h2>

    <div class="task">
      <span>Підпишись на канал +1⭐</span>
      <button id="subscribeBtn" class="btn">Перейти</button>
    </div>

    <div class="task" id="task50" style="justify-content:space-between;">
      <span>🎯 Досягни рекорду 75 (+10⭐)</span>
      <button id="checkTask50" class="btn" style="margin-left:auto;">Перевірити</button>
    </div>

    <div class="task" id="taskAdOncePerMinute">
      <span>🎬 Переглянь рекламу +0.15⭐ <small>(раз на 1 хв)</small></span>
      <button id="watchAdMinuteBtn" class="btn">Дивитись</button>
    </div>
    <div class="task" id="taskAdStatus" style="display:none;">
      <span>⌛ Наступний перегляд доступний через: <span id="adCooldownText">60с</span></span>
      <button class="btn" disabled>Очікуй…</button>
    </div>

    <div class="task" id="taskWatch5">
      <span>🎬 Переглянь 5 реклам (+1⭐) — <b id="ad5Counter">0/5</b></span>
      <button id="watchAd5Btn" class="btn">Дивитися</button>
    </div>
    <div class="task" id="taskWatch5Cooldown" style="display:none;">
      <span>⌛ «5 реклам» доступне через: <span id="ad5CooldownText">—</span></span>
      <button class="btn" disabled>Очікуй…</button>
    </div>

    <div class="task" id="taskWatch10">
      <span>🎬 Переглянь 10 реклам (+2⭐) — <b id="ad10Counter">0/10</b></span>
      <button id="watchAd10Btn" class="btn">Дивитися</button>
    </div>
    <div class="task" id="taskWatch10Cooldown" style="display:none;">
      <span>⌛ «10 реклам» доступне через: <span id="ad10CooldownText">—</span></span>
      <button class="btn" disabled>Очікуй…</button>
    </div>

    <div class="task" id="taskGames100" style="justify-content:space-between;">
      <span>🎮 Зіграй 100 ігор (+10⭐) — зіграно: <b id="gamesPlayedCounter">0</b>/100</span>
      <button id="checkGames100Btn" class="btn" style="margin-left:auto;">Перевірити</button>
    </div>
  </div>

  <!-- LEADERBOARD -->
  <div id="leaderboard" class="page themed">
    <div class="lb-header">
      <h2 class="lb-title">🏆 Лідерборд</h2>
      <div class="lb-sub">Попадай у ТОП — отримуй більше ⭐ за місце!</div>
    </div>
    <div id="lbList"></div>
    <div class="lb-note" id="lbNote"></div>
  </div>

  <!-- TOURNAMENTS -->
  <div id="tournaments" class="page">
    <div class="tour-hero">
      <div class="tour-hero-title">⚔️ Виклик суперника</div>
      <div class="tour-hero-sub">Згенеруй рекорд, зроби ставку ⭐ і побий його за 3 години</div>
    </div>

    <div class="challenge-card">
      <div class="challenge-row">
        <div>
          <div class="muted">Суперник</div>
          <div class="opponent-score" id="opponentScore">—</div>
        </div>
        <button class="btn" id="genOpponentBtn">Згенерувати</button>
      </div>

      <div class="challenge-row">
        <label for="stakeInput" class="muted">Ставка ⭐</label>
        <div class="stake-wrap">
          <input id="stakeInput" type="number" min="1" step="0.5" value="1" />
          <button class="btn" id="startChallengeBtn">Почати виклик (3 год)</button>
        </div>
      </div>

      <div class="challenge-info" id="challengeInfo">Немає активного виклику.</div>

      <div class="challenge-countdown" id="challengeCountdown" style="display:none;">
        ⏳ Залишилось: <span id="challengeLeft">03:00:00</span>
      </div>

      <div class="challenge-actions">
        <button class="btn" id="checkChallengeBtn" disabled>Перевірити</button>
        <span id="challengeStatus" class="muted"></span>
      </div>
    </div>

    <div class="battle-panel" aria-label="Правила батлу">
      <div class="inner">
        <div class="title">
          <div class="logo">⚔️</div>
          <div>BATTLES</div>
        </div>
        <div class="rules">
          <div class="pill">🎯 Мета: побий рекорд за 3 год</div>
          <div class="pill">💎 Виграш: ×1.5 від ставки</div>
          <div class="pill">⚠️ Якщо не встигаєш — ставка згорає</div>
        </div>
        <div class="cta">
          <button class="btn" onclick="document.getElementById('stakeInput').focus()">Зробити ставку</button>
        </div>
      </div>
    </div>
  </div>

  <!-- FRIENDS / WALLET -->
  <div id="friends" class="page themed">
    <div class="balance">Баланс ⭐ <span id="balance">0</span></div>
    <h2 class="wallet-title">💳 Гаманець</h2>

    <div class="share-card">
      <div><strong>Запроси друзів</strong></div>
      <p class="muted">Посилання на бота:</p>
      <p style="margin:8px 0;">
        <a href="https://t.me/Stacktongame_bot" class="btn" onclick="openBotLink(event)">➡ Відкрити бота @Stacktongame_bot</a>
      </p>
      <div class="share-row">
        <input id="shareLink" type="text" readonly value="https://t.me/Stacktongame_bot"/>
        <button class="btn" id="copyShareBtn">Скопіювати</button>
      </div>
      <div class="muted">Це одна силка для всіх 👍</div>
    </div>

    <div class="share-card">
      <div><strong>Вивід зірок</strong></div>
      <div class="muted">За натискання списується рівно 50⭐, решта лишається. Далі відкриється група/«Поділитися» з готовим повідомленням і двома кодами.</div>
      <div class="share-actions">
        <button class="btn" id="withdrawBtn">Вивести</button>
        <span id="withdrawStatus" class="muted"></span>
      </div>
    </div>

    <div class="share-card">
      <div><strong>Список виводів</strong></div>
      <ul id="payoutList" class="payout-list"></ul>
    </div>
  </div>

  <!-- SHOP -->
  <div id="shop" class="page themed">
    <h2 class="wallet-title" style="margin-top:12px">🛒 Оголошення</h2>

    <div class="share-card shop-card" style="text-align:center">
      <button class="info-btn" id="shopInfoBtn" aria-label="Info">i</button>

      <div class="info-pop" id="shopInfoPop">
        <p>Якщо бажаєте продати NFT, зірки чи інші подарунки — пишіть у лс.</p>
        <button class="btn" id="shopInfoClose">Закрити</button>
      </div>

      <p style="margin:6px 0 14px" class="muted">Виставити оголошення</p>
      <button class="btn" id="dmOwnerBtn">Написати в лс</button>
      <div class="muted" style="margin-top:8px">@yArOsUlAv</div>
    </div>
  </div>

  <!-- BOTTOM MENU -->
  <div class="menu">
    <button onclick="showPage('game', this)" class="active">🎮</button>
    <button onclick="showPage('tasks', this)">📝</button>
    <button onclick="showPage('leaderboard', this)">🏆</button>
    <button onclick="showPage('tournaments', this)">⚔️</button>
    <button onclick="showPage('friends', this)">👛</button>
    <button onclick="showPage('shop', this)">🛍️</button>
  </div>

  <!-- Libs -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r83/three.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/latest/TweenMax.min.js"></script>
  <script src="https://sad.adsgram.ai/js/sad.min.js"></script>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <!-- App helpers -->
  <script>
    function showPage(id, btn){
      document.querySelectorAll('.page').forEach(p => p.classList.toggle('active', p.id===id));
      document.querySelectorAll('.menu button').forEach(b => b.classList.toggle('active', b===btn));
      window.isPaused = (id !== 'game');
      if(id==='leaderboard'){ loadLeaderboard?.(); }
    }
    function openBotLink(e){
      if (window.Telegram && Telegram.WebApp) { Telegram.WebApp.openTelegramLink('https://t.me/Stacktongame_bot'); e.preventDefault(); }
    }
    function openDMto(username){
      const url = 'https://t.me/' + username.replace(/^@/,'');
      if (window.Telegram && Telegram.WebApp) Telegram.WebApp.openTelegramLink(url);
      else window.open(url,'_blank');
    }
    document.addEventListener('DOMContentLoaded', ()=>{
      document.getElementById('dmOwnerBtn')?.addEventListener('click', ()=>openDMto('@yArOsUlAv'));
      const infoBtn = document.getElementById('shopInfoBtn');
      const infoPop = document.getElementById('shopInfoPop');
      const infoClose = document.getElementById('shopInfoClose');
      infoBtn?.addEventListener('click', ()=>infoPop.classList.toggle('open'));
      infoClose?.addEventListener('click', ()=>infoPop.classList.remove('open'));
      document.addEventListener('click', (e)=>{ if (infoPop && !infoPop.contains(e.target) && !infoBtn.contains(e.target)) infoPop.classList.remove('open'); });
    });
  </script>

  <!-- Лідерборд (читає JSON з GitHub Pages / raw.githubusercontent) -->
  <script>
    /* 1) Укажи шлях до JSON із репозиторію */
    // ВАРІАНТ А: якщо файл лежить поряд на GitHub Pages (наприклад /leaderboard.json):
    // const LB_URL = location.origin + location.pathname.replace(/\/[^\/]*$/, '') + '/leaderboard.json';
    // ВАРІАНТ Б: вкажи raw URL напряму:
    const LB_URL = 'https://raw.githubusercontent.com/<твій-юзер>/<твій-репо>/main/leaderboard.json'; // 👈 ЗАМІНИ

    /* 2) Допоміжне: ім'я з Telegram (тег або ім'я — на майбутнє) */
    function getTelegramName(){
      const tg = (window.Telegram && Telegram.WebApp) ? Telegram.WebApp : null;
      const u = tg?.initDataUnsafe?.user;
      if(!u) return 'Player';
      if(u.username) return '@'+u.username;
      if(u.first_name && u.last_name) return u.first_name + ' ' + u.last_name;
      if(u.first_name) return u.first_name;
      return 'Player';
    }

    /* 3) Завантажити JSON */
    async function fetchLeaderboardJSON(){
      const url = LB_URL + (LB_URL.includes('?') ? '&' : '?') + 'v=' + Date.now(); // анти-кеш
      const res = await fetch(url, { headers:{'accept':'application/json'} });
      if(!res.ok) throw new Error('HTTP '+res.status);
      const data = await res.json();
      if(!Array.isArray(data)) throw new Error('Bad JSON format');
      return data;
    }

    /* 4) Рендер 1..50 із середнім стовпцем ?⭐ і рекордом праворуч */
    function renderLeaderboard(rows){
      const list = document.getElementById('lbList');
      const note = document.getElementById('lbNote');
      if(!list) return;

      rows.sort((a,b)=> (b.score||0) - (a.score||0));
      list.innerHTML = '';

      const total = 50;
      for(let i=0;i<total;i++){
        const r = rows[i];
        const rank = i+1;
        const name = r ? (r.name || 'Player') : '—';
        const score = r ? (typeof r.score==='number' ? r.score : '—') : '—';
        const avatar = `data:image/svg+xml;utf8,${encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><rect width="28" height="28" rx="14" fill="#1f2a44"/><text x="14" y="18" text-anchor="middle" font-size="14" fill="#9fb3ff">👤</text></svg>')}`;

        const row = document.createElement('div');
        row.className = 'lb-row ' + (rank===1?'rank-1':rank===2?'rank-2':rank===3?'rank-3':'');
        row.innerHTML = `
          <div class="lb-rank">${rank}</div>
          <div class="lb-name"><img src="${avatar}" alt=""><span class="txt">${name}</span></div>
          <div class="lb-bonus">?⭐</div>
          <div class="lb-score">${score}</div>
        `;
        list.appendChild(row);
      }
      if(note) note.textContent = 'Оновлено з GitHub.';
    }

    /* 5) Публічна функція, викликається при відкритті вкладки */
    async function loadLeaderboard(){
      try{
        const rows = await fetchLeaderboardJSON();
        renderLeaderboard(rows);
      }catch(e){
        renderLeaderboard([]); // порожня сітка 1..50
        const note = document.getElementById('lbNote');
        if(note) note.textContent = 'Не вдалось завантажити лідерборд: ' + (e?.message||e);
      }
    }
    window.loadLeaderboard = loadLeaderboard;

    // авто-підвантаження, якщо стартова вкладка — leaderboard
    document.addEventListener('DOMContentLoaded', ()=>{
      if(document.getElementById('leaderboard')?.classList.contains('active')){
        loadLeaderboard();
      }
    });
  </script>

  <!-- Основна логіка гри -->
  <script src="./script.js"></script>
</body>
</html>
